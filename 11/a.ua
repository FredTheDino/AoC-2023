I ← =@# ⊜∘≠, @\n &fras "input"

# Part 1
⊚ I
:□ ⊚ =0 ≡(/+) I
≡(⍜(⊡ 0|+⊙(/+<).⊙(°□)))
:□ ⊚ =0 ≡(/+) ⍉ I
≡(⍜(⊡ 1|+⊙(/+<).⊙(°□)))
⊞(+⊃(⌵-∩(⊡0)|⌵-∩(⊡1)) °□ ⊙(°□)) . ≡(□)
&p ÷2 /+ ♭

# Part 2
X ← 999999
⊚ I
:□ ⊚ =0 ≡(/+) I
≡(⍜(⊡ 0|+⊙(×X/+<).⊙(°□)))
:□ ⊚ =0 ≡(/+) ⍉ I
≡(⍜(⊡ 1|+⊙(×X/+<).⊙(°□)))
⊞(+⊃(⌵-∩(⊡0)|⌵-∩(⊡1)) °□ ⊙(°□)) . ≡(□)
&p ÷2 /+ ♭
